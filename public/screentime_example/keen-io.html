<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Screentime Example - Keen IO</title>


</head>
<body>
  <h1>Screentime Test Page</h1>
  <div id="top" style="background: #eee; height: 500px">#top</div>

  <div id="middle"  itemscope itemtype="http://schema.org/Product" style="background: #ddd; height: 300px">#middle
    <meta itemprop="url" content="https://www.dodocase.com/products/custom-ipad-pro-9-case">
    <meta itemprop="image" content="//cdn.shopify.com/s/files/1/0046/6182/products/pro_9_hero_grande.png?v=1469751071">
  </div>
  <div id="bottom" style="background: #ccc; height: 1000px">#bottom</div>
  <div id="end" style="background: #bbb; height: 1000px">#end</div>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  <script src="../screentime.js"></script>
  <link rel="stylesheet" href="../peekabar/jquery.peekabar.css">
  <script src="../peekabar/jquery.peekabar.js"></script>


  <script>
      // Create a bar
    var bar = $.peekABar({
      html: 'Custom Message',
      delay: 2000,
      autohide: false,
      padding: '2em',
      backgroundColor: 'rgb(195, 195, 195)',
      animation: {
          type: 'fade',
          duration: '2000'
      },
      opacity: '0.8',
      cssClass: 'custom-class',
      position: 'bottom',
      closeOnClick: true,
      onShow: function() {
          console.log('called after bar is shown');
      },
      onHide: function() {
          console.log('called after bar is hidden');
      }
    });

    var elem = $("meta[itemprop='image']").parent();
    var total = 0;
    var targeted_time = 30;
    $.screentime({
      fields: [
        { selector: elem,
          name: 'Middle'
        }
      ],
      reportInterval: 1,
      callback: function(data) {
        $.each(data, function(key, val) {
          total = total + val
        });
        if (total >= targeted_time) {
          console.log("Display")
          bar.show({
             html: "<p class='bizztext'>Drive more attention to your most important website content with Bizz Bar. <button class='bizzbutton'>Click me</button></p>"
          });
        }
        console.log( total);
      }
    });
  </script>
 
</body>
</html>